{
  "id": "d8o",
  "title": "Ticks Schema \u0026 CLI Changes",
  "description": "Add requires, awaiting, and verdict fields to tick schema. Implement CLI commands (tk approve, tk reject) and flags (--requires, --awaiting, --verdict). Handle backwards compatibility with manual field.",
  "notes": "2026-01-14 17:41 - Completed ztr: Added Requires (*string), Awaiting (*string), and Verdict (*string) pointer fields to Task struct in internal/ticks/types.go. Used pointer types so nil represents 'not set' and omitempty works correctly for JSON. Added IsAwaitingHuman() and GetAwaitingType() helper methods. All tests pass.\n2026-01-14 17:44 - Completed agk: Implemented backwards compatibility for manual field. Key changes: (1) IsAwaitingHuman() and GetAwaitingType() now check Manual field as fallback when Awaiting is nil - treating manual=true as awaiting=work. (2) Added SetAwaiting(type) method that clears Manual when setting Awaiting, and ClearAwaiting() that clears both. (3) No query filter changes were needed since ticker uses tk next which handles filtering via CLI. The pattern reads both fields but writes only the new awaiting field.\n2026-01-14 17:45 - Completed 2z9: Added SetAwaiting and ClearAwaiting methods to ticks Client. Methods delegate to tk CLI using 'tk update --awaiting \u003cvalue\u003e' pattern. SetAwaiting accepts optional note for context. Note: These methods assume tk CLI supports --awaiting flag - if tk hasn't been updated yet, these will error at runtime. Added after SetStatus method at line ~207 in client.go.\n2026-01-14 17:47 - Completed v8u: Added SetVerdict method to ticks Client. Key changes: (1) Updated AddNote to accept variadic extraArgs to support --from flag. (2) SetVerdict adds feedback note BEFORE setting verdict to ensure atomicity - the note is available when verdict triggers downstream processing. (3) Uses --from human flag for feedback notes. Note: Like SetAwaiting/ClearAwaiting, this assumes tk CLI supports --verdict flag.\n2026-01-14 17:50 - Completed hch: Implemented verdict processing logic. ProcessVerdict method on Task struct handles the matrix: work/approval/review/content close on approved; input/escalation close on rejected; checkpoint never closes. Client.ProcessVerdict reads/processes/saves tick files directly. VerdictResult type communicates outcome. All transient fields cleared but requires persists. 19 test cases added. Files: internal/ticks/types.go (ProcessVerdict, VerdictResult), internal/ticks/client.go (Client.ProcessVerdict), internal/ticks/client_test.go.\n2026-01-14 17:53 - Completed rfx: NextTask now filters out awaiting tasks. Key changes: (1) NextTask checks IsAwaitingHuman() on task from tk next, if true falls back to local filtering via findNextReadyTask(). (2) findNextReadyTask() gets all tasks from ListTasks and filters for: open status, not blocked, not awaiting human (Awaiting field or Manual flag). (3) Added 5 tests covering awaiting/blocked/closed filtering and the all-awaiting-returns-nil edge case. Files modified: internal/ticks/client.go (NextTask updated, added findNextReadyTask helper), internal/ticks/client_test.go (5 new tests).\n2026-01-14 17:55 - Completed q56: Added CompleteTask method to Client. It checks task.Requires pointer, if set (non-nil and non-empty string) calls SetAwaiting(taskID, *task.Requires, note) to route to human, otherwise closes directly via CloseTask. The requires field persistence was already handled by ProcessVerdict which clears awaiting/verdict but NOT requires. Engine can now use CompleteTask instead of CloseTask directly. Files: internal/ticks/client.go (new method), internal/ticks/client_test.go (5 tests).\n2026-01-14 17:58 - Completed 92v: Added NextAwaitingTask method to Client in internal/ticks/client.go:67. Method signature: NextAwaitingTask(epicID string, awaitingTypes ...string) (*Task, error). Builds args like ['next', epicID?, '--awaiting', types?, '--json']. Handles error messages for 'no awaiting'/'no tasks'. Note: This method assumes tk CLI supports 'tk next --awaiting [types]' flag - if not implemented in tk yet, will error at runtime.",
  "status": "open",
  "priority": 2,
  "type": "epic",
  "owner": "peter@engelbrecht.dk",
  "parent": "zt5",
  "created_by": "peter@engelbrecht.dk",
  "created_at": "2026-01-14T16:11:02.312478Z",
  "updated_at": "2026-01-14T16:58:08.880762Z"
}