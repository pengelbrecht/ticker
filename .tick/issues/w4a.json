{
  "id": "w4a",
  "title": "Implement CommandVerifier base for running shell commands",
  "description": "Create a base CommandVerifier that executes shell commands and captures output. This is the foundation for TestVerifier, BuildVerifier, and ScriptVerifier.\n\n## Files to Create\n\n### internal/verify/command.go\n\n```go\n// CommandVerifier runs a shell command as verification.\ntype CommandVerifier struct {\n    name    string\n    command string\n    dir     string // working directory\n}\n\n// NewCommandVerifier creates a verifier that runs the given command.\n// The name is used for display (e.g., \"test\", \"build\").\n// The command is executed via sh -c in the specified directory.\nfunc NewCommandVerifier(name, command, dir string) *CommandVerifier\n\n// Name returns the verifier name.\nfunc (v *CommandVerifier) Name() string\n\n// Verify runs the command and returns the result.\n// Passes if exit code is 0, fails otherwise.\n// Captures both stdout and stderr in Result.Output.\n// Respects context cancellation/timeout.\nfunc (v *CommandVerifier) Verify(ctx context.Context, taskID string, agentOutput string) *Result\n```\n\n## Implementation Notes\n\n- Use exec.CommandContext for cancellation support\n- Combine stdout and stderr (order-preserving if possible)\n- Capture exit code in error message on failure\n- Set working directory via cmd.Dir\n- Measure duration with time.Now()/time.Since()\n- Handle command not found gracefully\n- Limit output capture to reasonable size (~100KB) to avoid memory issues\n\n### internal/verify/command_test.go\n- Test successful command (exit 0)\n- Test failing command (exit non-zero)\n- Test command not found\n- Test context cancellation\n- Test output capture (stdout + stderr)\n- Test working directory is respected",
  "status": "closed",
  "priority": 2,
  "type": "task",
  "owner": "peter@engelbrecht.dk",
  "blocked_by": [
    "194"
  ],
  "parent": "t99",
  "acceptance_criteria": "1. CommandVerifier implements Verifier interface\n2. Successful commands (exit 0) return Result with Passed=true\n3. Failed commands return Result with Passed=false and captured output\n4. Context cancellation stops the command\n5. Both stdout and stderr are captured in Result.Output\n6. Working directory is respected\n7. Duration is measured accurately\n8. Command not found returns descriptive error\n9. All unit tests pass",
  "created_by": "peter@engelbrecht.dk",
  "created_at": "2026-01-12T09:00:26.426402Z",
  "updated_at": "2026-01-12T09:01:55.956759Z",
  "closed_at": "2026-01-12T09:01:55.956759Z"
}