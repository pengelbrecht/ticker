{
  "id": "cd5",
  "title": "Add headless output support for parallel multi-epic execution",
  "description": "Ensure headless mode works well with parallel multi-epic execution. Output must clearly distinguish which epic is producing each line.\n\n## Problem\n\nWhen running multiple epics in parallel with `--headless`, output from different epics will be interleaved. Without clear prefixes, it's impossible to tell which epic produced which output.\n\n## Design\n\n### Default format (human + LLM readable)\n\n```bash\nticker run epic1 epic2 epic3 --headless --parallel 3\n```\n\n```\n[epic1] [START] Feature Implementation\n[epic2] [START] Bug Fixes\n[epic1] [TASK] abc - Add authentication\n[epic2] [TASK] xyz - Fix login bug\n[epic1] [OUTPUT] Reading auth code...\n[epic2] [OUTPUT] Analyzing bug...\n[epic2] [ERROR] Test failed: expected 200, got 500\n[epic1] [TASK_COMPLETE] abc\n[epic2] [OUTPUT] Fixing test...\n[epic2] [TASK_COMPLETE] xyz\n[epic1] [COMPLETE] 3 tasks, 5 iterations, $0.82\n[epic2] [COMPLETE] 2 tasks, 4 iterations, $0.65\n[SUMMARY] All epics complete. Total: $1.47\n```\n\n### JSON Lines format\n\n```bash\nticker run epic1 epic2 --headless --jsonl\n```\n\n```json\n{\"epic_id\":\"epic1\",\"type\":\"start\",\"title\":\"Feature Implementation\"}\n{\"epic_id\":\"epic2\",\"type\":\"start\",\"title\":\"Bug Fixes\"}\n{\"epic_id\":\"epic1\",\"type\":\"task\",\"task_id\":\"abc\",\"title\":\"Add auth\"}\n{\"epic_id\":\"epic2\",\"type\":\"error\",\"text\":\"Test failed\"}\n{\"epic_id\":\"epic1\",\"type\":\"complete\",\"iterations\":5,\"cost\":0.82}\n{\"type\":\"summary\",\"total_cost\":1.47,\"all_success\":true}\n```\n\n## Implementation\n\n### Extend HeadlessOutput (from task 60a)\n\n```go\ntype HeadlessOutput struct {\n    jsonl    bool\n    writer   io.Writer\n    mu       sync.Mutex  // Protect concurrent writes\n    epicID   string      // Set per-epic, prefix all output\n}\n\nfunc (h *HeadlessOutput) SetEpicID(id string)\n```\n\n### Wire into ParallelRunner\n\nEach epic's engine gets its own HeadlessOutput with epicID set. Mutex ensures output lines don't get corrupted.\n\n### Single epic backwards compatibility\n\nWhen running single epic, omit the [epicID] prefix to keep output clean:\n```\n[TASK] abc - Add auth\n[OUTPUT] Working...\n```\n\n## Integration with 60a\n\nThis task extends the work from 60a (LLM-optimized headless). The epic prefix is added to the output format defined there.",
  "status": "closed",
  "priority": 2,
  "type": "task",
  "owner": "peter@engelbrecht.dk",
  "blocked_by": [
    "91k"
  ],
  "parent": "8my",
  "acceptance_criteria": "1. Multi-epic headless output prefixes each line with [epic_id]\n2. Single-epic headless output has no prefix (backwards compatible)\n3. JSONL format includes epic_id field in each object\n4. Concurrent output is protected by mutex (no corrupted lines)\n5. Final summary shows total across all epics\n6. Errors clearly attributed to correct epic\n7. Works with both --parallel N and sequential multi-epic",
  "created_by": "peter@engelbrecht.dk",
  "created_at": "2026-01-12T21:58:29.707066Z",
  "updated_at": "2026-01-13T15:07:29.470223Z",
  "closed_at": "2026-01-13T15:07:29.470223Z"
}