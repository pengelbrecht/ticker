Now let me gather a few more specific details to complete the context document.

I now have enough information to generate the comprehensive context document. Let me compile it.

---

# Epic Context: Phase 3 - Verification System [t99]

## Status: Verification System Already Implemented

The exploration reveals that **all core verification functionality is already implemented**. The tasks in this epic may be outdated or already completed.

---

## 1. Existing Implementation Summary

### `internal/verify/` Package (COMPLETE)

| File | Purpose | Key Lines |
|------|---------|-----------|
| `verify.go` | `Verifier` interface, `Result`, `Results` types | 12-20 (interface), 23-38 (Result), 51-57 (Results) |
| `git_verifier.go` | Checks uncommitted changes | 44-89 (Verify), 19-22 (excluded paths) |
| `runner.go` | Orchestrates verifiers | 23-40 (Run method) |
| `config.go` | Config loading from `.ticker/config.json` | 12-25 (Config), 149-174 (LoadTickerConfig) |

### Engine Integration (COMPLETE)

**`internal/engine/engine.go`**:
- `verifyEnabled` field (line 65-66)
- `OnVerificationStart/OnVerificationEnd` callbacks (lines 65-66)
- `wasTaskClosed()` method (lines 1094-1101)
- `runVerification()` method (lines 1103-1137)
- Iteration loop hook (lines 749-820)

**Verification flow in iteration loop**:
```
Lines 749-820:
1. Check task closed: wasTaskClosed(task.ID)
2. Run verification: runVerification(ctx, taskID, output, epicID, workDir)
3. On failure: ReopenTask() + AddNote() with failure details
4. On pass: add to completedTasks
```

### TUI Integration (COMPLETE)

**`internal/tui/model.go`**:
- `VerifyStartMsg`, `VerifyResultMsg` (lines 176-186)
- `verifying` state field (line 747)
- Update handler (lines 1507-1538)
- Status indicator shows "üîç verifying" (lines 2552-2564)

### CLI Flags (COMPLETE)

**`cmd/ticker/main.go`**:
- `--skip-verify` flag (line 243)
- `--verify-only` flag (line 244)
- `isVerificationEnabled()` function (lines 2073-2091)

---

## 2. Key Interfaces & Types

### Verifier Interface (`verify.go:12-20`)
```go
type Verifier interface {
    Name() string
    Verify(ctx context.Context, taskID string, agentOutput string) *Result
}
```

### Result Struct (`verify.go:23-38`)
```go
type Result struct {
    Verifier string
    Passed   bool
    Output   string
    Duration time.Duration
    Error    error
}
```

### Config (`config.go:12-25`)
```go
type Config struct {
    Enabled *bool `json:"enabled,omitempty"`
}

func (c *Config) IsEnabled() bool // default true
```

---

## 3. Integration Points

### Engine Callbacks
```go
// engine.go:65-66
OnVerificationStart func(taskID string)
OnVerificationEnd   func(taskID string, results *verify.Results)
```

### TUI Messages
```go
// model.go:176-186
type VerifyStartMsg struct{ TaskID string }
type VerifyResultMsg struct {
    TaskID  string
    Passed  bool
    Summary string
}
```

### Ticks Client Methods
```go
// ticks/client.go
CloseTask(taskID, reason string)      // line 491
ReopenTask(taskID string)             // line 518
AddNote(issueID, message string)      // line 533
```

---

## 4. Excluded Paths

GitVerifier ignores ticker metadata (`git_verifier.go:19-22`):
```go
var excludedPaths = []string{
    ".tick/",
    ".ticker/",
}
```

---

## 5. Testing Patterns

### Mock Verifier (`runner_test.go:9-45`)
```go
type mockVerifier struct {
    name   string
    passed bool
    output string
    delay  time.Duration
}
```

### Temp Git Repo Helper (`git_verifier_test.go:173-216`)
```go
func createTempGitRepo(t *testing.T) string
```

### Test Coverage
- Result/Results formatting
- Runner orchestration with cancellation
- GitVerifier with clean/dirty trees
- Config loading with missing/invalid files

---

## 6. Configuration

**`.ticker/config.json`**:
```json
{
  "verification": {
    "enabled": true
  }
}
```

Default: `enabled = true` (verification runs unless explicitly disabled).

---

## 7. Conventions

### Error Handling
- Verification errors are non-fatal (logged, not abort)
- Failed verification ‚Üí reopen task + add epic note
- Agent retries on next iteration

### Logging Hierarchy
1. `e.runLog.Log*()` - structured JSON (analysis)
2. `e.OnOutput()` callback - TUI display
3. `e.ticks.AddNote()` - agent visibility

### Code Patterns
- Pointer-to-primitive for optional config fields
- Getter methods with defaults (e.g., `IsEnabled()`)
- Context cancellation support throughout

---

## 8. What Tasks Remain?

Based on code exploration, the epic's tasks appear to be **already implemented**:

| Task | Status |
|------|--------|
| [194] Create verify package with Verifier interface | ‚úÖ Done |
| [t6v] Integrate verification into engine loop | ‚úÖ Done |
| [3nt] Create VerificationConfig and file loading | ‚úÖ Done |
| [gce] Project type auto-detection | ‚ùì Not implemented (but epic says GitVerifier only) |
| [w4a] CommandVerifier base | ‚ùì Not implemented (rejected in design) |
| [u9m] TestVerifier and BuildVerifier | ‚ùì Not implemented (rejected in design) |
| [ct4] ScriptVerifier | ‚ùì Not implemented (rejected in design) |
| [mph] GitVerifier | ‚úÖ Done |
| [kvd] VerificationRunner | ‚úÖ Done |
| [eni] CLI flags | ‚úÖ Done |
| [y37] TUI verification status | ‚úÖ Done |

**Note**: Tasks gce, w4a, u9m, ct4 were explicitly rejected in the design decision ("GitVerifier only"). The core tasks (194, t6v, 3nt, mph, kvd, eni, y37) are all implemented.